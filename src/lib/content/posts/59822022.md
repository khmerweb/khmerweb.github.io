---
id: '59822022'
title: 'ក្បួន POST'
categories: 'Node.js, Sveltekit'
thumb: ''
date: '2025-08-20T15:59:31'
bookTitle: 'SvelteKit in Detail'
bookThumb: ''
bookChapter: 'អំពី​ផ្លូវ API'
videos: ''
---
<p>តាម​ធម្មតា យើង​អាច​ប្រើប្រាស់​ក្បួន​ឆ្លើយតប​ទំរង់បែបបទ ដែល​ជាធាតុ​នៃ​សំណុំ​ទិន្នន័យ actions ក្នុងការបញ្ជូន​ទិន្នន័យ​ទៅ​កាន់ server ដើម្បី​ឆ្លើយ​តប​ទៅ​នឹង​វិធី HTTP POST នៅ​ក្នុង​ទំរង់បែបបទ​។ លើស​ពី​នេះ​ទៀត យើង​ក៏​អាច​ប្រើប្រាស់​ក្បួន​ឈ្មោះ POST នៅក្នុង​ឯកសារ +server.js នៃ​ផ្លូវ API ក្នុង​ការបញ្ជូន​ទិន្នន័យ​ទៅ​កាន់មូលដ្ឋាន​ទិន្នន័យ​បាន​ដែរ​។ ពិនិត្យ​កម្មវិធី​ខាងក្រោម​នេះ៖</p><pre><code class="svelte">&lt;!--src/routes/+page.svelte--&gt;
&lt;script&gt;
	let { data } = $props();
&lt;/script&gt;

&lt;div class="centered"&gt;
	&lt;h1&gt;todos&lt;/h1&gt;

	&lt;label&gt;
		add a todo:
		&lt;input
			type="text"
			autocomplete="off"
			onkeydown={async (e) =&gt; {
				if (e.key !== 'Enter') return;

				const input = e.currentTarget;
				const description = input.value;
				
				const response = await fetch('./api/todo', {
					method: 'POST',
					body: JSON.stringify({ description }),
					headers: {
						'Content-Type': 'application/json'
					}
				});

				const { id } = await response.json();

				const todos = [...data.todos, {
					id,
					description
				}];

				data = { ...data, todos };

				input.value = '';
			}}
		/&gt;
	&lt;/label&gt;

	&lt;ul class="todos"&gt;
		{#each data.todos as todo (todo.id)}
			&lt;li&gt;
				&lt;label&gt;
					&lt;input
						type="checkbox"
						checked={todo.done}
						onchange={async (e) =&gt; {
							const done = e.currentTarget.checked;

							// TODO handle change
						}}
					/&gt;
					&lt;span&gt;{todo.description}&lt;/span&gt;
					&lt;button
						aria-label="Mark as complete"
						onclick={async (e) =&gt; {
							// TODO handle delete
						}}
					&gt;&lt;/button&gt;
				&lt;/label&gt;
			&lt;/li&gt;
		{/each}
	&lt;/ul&gt;
&lt;/div&gt;

&lt;style&gt;
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}

	label {
		display: flex;
		width: 100%;
	}

	input[type="text"] {
		flex: 1;
	}

	span {
		flex: 1;
	}

	button {
		border: none;
		background: url(./remove.svg) no-repeat 50% 50%;
		background-size: 1rem 1rem;
		cursor: pointer;
		height: 100%;
		aspect-ratio: 1;
		opacity: 0.5;
		transition: opacity 0.2s;
	}

	button:hover {
		opacity: 1;
	}
&lt;/style&gt;</code></pre><pre><code class="js javascript js-code">// src/routes/api/todo/+server.js
import { json } from '@sveltejs/kit';
import * as database from '$lib/server/database.js';

export async function POST({ request, cookies }) {
	const { description } = await request.json();

	const userid = cookies.get('userid');
	const { id } = await database.createTodo({ userid, description });

	return json({ id }, { status: 201 });
}

export async function GET({ cookies }) {
    const userid = cookies.get('userid');
    const todos = await database.getTodos(userid);

    return json(todos);
}</code></pre><pre><code class="js javascript js-code">// src/lib/server/database.js
const database = new Map();

export function getTodos(userid) {
	if (!database.has(userid)) {
		createTodo({ userid, description: 'Learn about API routes' });
	}

	return Array.from(database.get(userid).values());
}

export function createTodo({ userid, description }) {
	if (!database.has(userid)) {
		database.set(userid, new Map());
	}

	const todos = database.get(userid);

	const id = crypto.randomUUID();

	todos.set(id, {
		id,
		description,
		done: false
	});

	return {
		id
	};
}

export function toggleTodo({ userid, id, done }) {
	const todos = database.get(userid);
	todos.get(id).done = done;
}

export function deleteTodo({ userid, id }) {
	const todos = database.get(userid);
	todos.delete(id);
}</code></pre>