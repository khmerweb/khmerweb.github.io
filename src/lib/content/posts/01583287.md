---
id: '01583287'
title: 'លុប​ឯកសារ MD'
categories: 'Node.js, Sveltekit'
thumb: ''
date: '2025-10-02T17:31:03'
bookTitle: 'Desktop App with Electron'
bookThumb: ''
bookChapter: 'Electron & SvelteKit'
videos: ''
---
<p>ការលុប​ឯកសារ MD ប្រព្រឹត្ត​ទៅ​ដោយ​យក​ក្បួន​ខ្នាត​ពី​ក្នុង​កញ្ចប់ Node.js មក​ប្រើប្រាស់​។ កត្តានេះ​ទាមទារ​អោយ​យើង​ត្រូវ​សរសេរ​កូដ​នៅ​ក្នុង​ឯកសារ main.ts ព្រោះ​មាន​តែ​ឯកសារ​នេះទេ ដែល​មាន​សិទ្ធិ​អាច​ប្រើប្រាស់​ក្បួន​ខ្នាត​ទាំងនោះ​បាន​។ ការភ្ជាប់​ទំនាក់ទំនង​ជាមួយ​​នឹង​ឯកសារ main.ts ក្នុង​ការលុប​ឯកសារ MD ណាមួយ​ អាច​ត្រូវ​ធ្វើ​ឡើង​នៅ​ក្នុង​ឯកសារ preload.cjs ដូច​ខាង​ក្រោម​នេះ៖</p><pre><code class="js javascript js-code">// electron/preload.cjs
const { contextBridge, ipcRenderer } = require('electron')

contextBridge.exposeInMainWorld('electronAPI', {
    getWindowHeight: () =&gt; ipcRenderer.invoke('get-window-height'),
    onUpdateWindowHeight: (callback) =&gt; ipcRenderer.on('update-window-height', callback),
    saveFile: (fileContent, filePath) =&gt; ipcRenderer.invoke('save-file', fileContent, filePath),
    getFiles: () =&gt; ipcRenderer.invoke('get-files'),
    getFile: (filePath) =&gt; ipcRenderer.invoke('get-file', filePath),
    deleteFile: (filePath) =&gt; ipcRenderer.invoke('delete-file', filePath),
})</code></pre><p>&nbsp;</p><p>ជាការឆ្លើយតប នៅ​ក្នុង​ឯកសារ main.ts ត្រូវ​មាន​​ក្បួន​ឆ្លើយតប​ហេតុការណ៍​​មួយ​ដូច​ខាង​ក្រោម​នេះ៖</p><pre><code class="typescript">// electron/main.ts
import { app, BrowserWindow, Menu, ipcMain, dialog } from 'electron';
...
import fileTools from "./file-utils.ts";

ipcMain.handle('delete-file', async (event, filePath) =&gt; {
    const result = await fileTools.deleteFile(filePath);
    return result
})
...</code></pre><p>&nbsp;</p><p>ដោយ​ឯកសារ​ខាង​លើ​នេះ​ប្រើប្រាស់​ក្បួន​ខ្នាត​នៅ​ក្នុង​សាស្ត្រា file-utils.ts ក្នុង​ការលុប​ឯកសារ MD អាស្រ័យ​ហេតុនេះ​សាស្ត្រា file-utils.ts ត្រូវ​មាន​ក្បួន​លុប​ឯកសារ​ដូច​ខាង​​ក្រោម​៖</p><pre><code class="typescript">// electron/file-utils.ts
import fs from 'fs';
import path from 'node:path';
const { randomUUID } = new ShortUniqueId({ length: 15, dictionary: 'number' });
import matter from 'gray-matter';
...

class FileTools{
	...
	async deleteFile(filePath: string){
        if(filePath.length){
            try {
                fs.unlink(filePath, (err) =&gt; {
                    if (err) {
                        console.error('Error deleting file:', err);
                        return
                    }
                })

                return {success: true};
            } catch (err) {
                console.error('Error deleting file synchronously:', err);
            }
        }
    }
}

export default new FileTools()</code></pre><p>&nbsp;</p><p>នៅ​ក្នុង​កម្មវិធី &nbsp;SvelteKit ការយក​ក្បួន​ខ្នាត​ពី​ក្នុង​កញ្ចប់ Node.js មក​ប្រើ​ប្រាស់ តាមរយៈ​ឯកសារ preload.cjs អាច​ត្រូវ​ធ្វើឡើង​នៅ​ក្នុង​សមាសភាគ Menu.svelte ដូច​ខាងក្រោម​នេះ៖</p><pre><code class="svelte">&lt;!--src/lib/components/Menu.svelte--&gt;
&lt;script lang="ts"&gt;
const { deleteFile } = $props()
&lt;/script&gt;

...
&lt;div class="navbar"&gt;
  &lt;div class="dropdown"&gt;
    &lt;button class="dropbtn"&gt;ឯកសារ
      &lt;i class="fa fa-caret-down"&gt;&lt;/i&gt;
    &lt;/button&gt;
    &lt;div class="dropdown-content"&gt;
      &lt;button&gt;អំពើ​ទី ១&lt;/button&gt;
      &lt;button&gt;អំពើ​ទី ២&lt;/button&gt;
      &lt;button onclick={deleteFile}&gt;លុប​ឯកសារ MD&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;a&gt;ជំនួយ&lt;/a&gt;
&lt;/div&gt;
...</code></pre><p>&nbsp;</p><p>យើង​អាច​ផ្តល់​ក្បួន​ឬ​វិធី deleteFile ក្រោម​រូបភាព​ជា props អោយ​ទៅ​សមាសភាគ Menu.svelte បាន​ដោយ​ធ្វើ​ដូច​ខាង​ក្រោម​នេះ៖</p><pre><code class="svelte">&lt;!--src/routes/+page.svelte--&gt;
&lt;script lang="ts"&gt;
import tool from "./editor-utils";
...
&lt;/script&gt;

...
&lt;div class="app-container"&gt;
    &lt;div class="menu-bar"&gt;
        &lt;Menu deleteFile={tool.deleteFile} /&gt;n
    &lt;/div&gt;
    ...
&lt;/div&gt;</code></pre><p>&nbsp;</p><p>ចុង​ក្រោយ​បង្អស់ នៅ​ក្នុង​សាស្ត្រា editor-utils.ts ត្រូវ​មាន​វិធី​មួយ​ដូច​ខាងក្រោម​នេះ៖</p><pre><code class="typescript">// src/routes/editor-utils.ts
import { eleState, dialogState, fileState } from '$lib/store/state.svelte';

class EditorTools{
	...
	async deleteFile(){
        if(fileState.filePath.length){
            await (window as any).electronAPI.deleteFile(fileState.filePath);
            fileState.fileResult = await (window as any).electronAPI.getFiles();
            fileState.filePath = '';
            eleState.videos = [];
            eleState.json = '';
            document.querySelector('form')?.reset();
        }
    }
}

export default new EditorTools()</code></pre>