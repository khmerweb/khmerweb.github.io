---
id: '37594391'
title: 'យន្តការ​ត្រួតពិនិត្យ'
categories: 'Node.js, Astro'
thumb: ''
date: '2025-08-28T14:24:35'
bookTitle: 'Astro Dynamic Website'
bookThumb: ''
bookChapter: 'ទំព័រ​ចូល​ក្នុង'
videos: ''
---
<p>យន្តការ​ត្រួត​ពិនិត្យ​គឺ​ជា​ដំណើរការ​ត្រួត​ពិនិត្យ​មើល​ថា តើ​អ្នក​ចុះឈ្មោះ​ចូល​ទៅ​កាន់​ទំព័រ​គ្រប់គ្រង​ (dashboard) ពិត​ជា​ត្រូវ​បាន​ចុះ​បញ្ជីរ​​នៅ​ក្នុង​មូលដ្ឋាន​ទិន្នន័យ​ដែរ​ឬទេ​។ ការត្រួត​ពិនិត្យ​គឹ​ធ្វើឡើង​ដោយ​យក​ Email និង​ពាក្យ​សំងាត់​របស់​អ្នក​ចុះឈ្មោះ​​ទៅ​ផ្ទៀងផ្ទាត់មើល​នៅ​ក្នុងមូលដ្ឋាន​ទិន្នន័យ បើ​សិន​ពិត​ជា​មាន អ្នក​ចុះ​ឈ្មោះ​នឹង​ត្រូវ​អនុញ្ញាតិ​អោយ​ចូល​ទៅ​កាន់​ទំព័រ​គ្រប់គ្រង (dashboard) បើ​អត់មាន​ទេ អ្នក​នោះ​​នឹង​មិន​ត្រូវ​អនុញ្ញាតិ​អោយ​ចូល​ទៅ​ទំព័រ​គ្រប់គ្រង និង​ប្រាប់​ពីកំហុស​បណ្តាល​មក​ពី​ខុស​ Email ឬខុស​ពាក្យ​សំងាត់​។</p><pre><code class="svelte">&lt;!--src/pages/login.astro--&gt;
---
import Base from "../components/Base.astro"
import bcrypt from "bcryptjs"
import user from "../models/user.js"

let message = ''
if(Astro.request.method === "POST"){
    const data = await Astro.request.formData()
    const email = data.get("email")
    const password = data.get("password")

    let loginUser = null
    const validate = (
        typeof email === 'string' &amp;&amp; email !== '' &amp;&amp;
        typeof password === 'string' &amp;&amp; password !== ''
    )
    if(validate){
        loginUser = await user.checkUser(email)
    }else{
        message = "ទិន្នន័យ​បញ្ជូន​មក​មិន​ត្រឹមត្រូវ​ទេ!"
    }
    
    if(loginUser){
        if(bcrypt.compareSync(password, loginUser.password)){
            await Astro.session?.set('user', loginUser)
            return Astro.redirect("/admin")
        }else{
            message = 'ពាក្យ​សំងាត់​មិន​ត្រឹមត្រូវ​ទេ'         
        }
    }else{
        message = 'Email មិន​ត្រឹមត្រូវទេ'
    }
}
---

&lt;Base pageTitle="Login"&gt;
    &lt;div class="wrapper"&gt;
        &lt;h2&gt;ចុះ​ឈ្មោះ​ចូល​ទំព័រ​គ្រប់គ្រង&lt;/h2&gt;
        &lt;form action="/login" method="POST"&gt;
            &lt;label for="email"&gt;Email:&lt;/label&gt;
            &lt;input type="text" id="email" name="email" required /&gt;
            &lt;br /&gt;
            &lt;label for="password"&gt;ពាក្យ​សំងាត់ៈ&lt;/label&gt;
            &lt;input type="password" id="password" name="password" required /&gt;
            &lt;br /&gt;
            &lt;button type="submit"&gt;បញ្ជូន&lt;/button&gt;
            &lt;p style="color: red;text-align:center"&gt;{message}&lt;/p&gt;
        &lt;/form&gt;
    &lt;/div&gt;
&lt;/Base&gt;

&lt;style&gt;
    .wrapper {
        max-width: 300px;
        margin: 100px auto;
        background-color: lightgrey;
    }

    .wrapper h2 {
        padding: 10px 0;
        font: normal 20px/1.5 Koulen;
        text-align: center;
        background-color: #333;
        color: white;
    }

    .wrapper form {
        display: flex;
        flex-direction: column;
        padding: 0 20px 20px;
        font: 14px/1.5 Vidaloka, OdorMeanChey;
    }
    
    .wrapper form input {
        padding: 8px;
    }
    
    .wrapper form button {
        font: 14px/1.5 OdorMeanChey;
        padding: 10px;
        background-color: #4CAF50;
        color: white;
        border: none;
        cursor: pointer;
    }
    
    .wrapper form button:hover {
        background-color: #45a049;
    }
&lt;/style&gt;</code></pre><p>&nbsp;</p><p>យ៉ាងណាម៉ិញ សំរាប់​ប្រព័ន្ធ Netlify បើ​គ្មាន​តំណរភ្ជាប់​ទៅ​កាន់​មូលដ្ឋាន​ទិន្នន័យ​និង​ token ទេ កម្មវិធី​គេហទំព័រ​របស់​យើង​នឹង​មិន​អាច​ដំណើរ​ការ​​នៅ​លើ​ប្រព័ន្ធ​នេះ​បាន​ឡើយ ពីព្រោះ​អ្វី​ៗ​ដែល​ត្រូវ​បាន​កត់ត្រា​ទុក​នៅ​ក្នុង​ឯកសារ .env គឺសំរាប់​ប្រើប្រាស់​តែ​នៅ​ក្នុង​កំព្យូទ័រ​ផ្ទាល់​ខ្លួនតែ​ប៉ុណ្ណោះ វា​នឹង​មិន​ត្រូវបានចំលង​​ទៅ​ប្រព័ន្ធ GitHub ឬ​ប្រព័ន្ធ Netlify ឡើយ​។ តែ​មាន​វិធី​មួយ​ដែល​អាច​ដោះ​ស្រាយ​បញ្ហា​នេះ​បាន គឺ​យើង​ត្រូវ​ចំលង​យក​ token ​និង​តំណរភ្ជាប់​ទៅ​កាន់​មូលដ្ឋាន​ទិន្នន័យ ទៅ​ដាក់​នៅ​លើ​ប្រព័ន្ធ​ Netlify ដោយ​ខ្លួន​យើង​ផ្ទាល់​តែ​ម្តង​។</p><p>&nbsp;</p><p>នៅ​លើ​ប្រព័ន្ធ Netlify យើង​អាច​ចំលង​យក​ token ​និង​តំណរភ្ជាប់​ទៅ​មូលដ្ឋាន​ទិន្នន័យ​ ទៅ​ដាក់​នៅ​លើ​ប្រព័ន្ធ​នោះ​បាន​ដោយចុច​លើ​កម្មវិធី​គេហទំព័រ​ដែល​ត្រូវការ​ token និង​តំណរភ្ជាប់​នោះ រួច​ចុច Project configuration និង​ចុច Environment variables ចុច Add a variable ចុច Import from a .env file និង​ចំលង​យក​អ្វី​ៗ​ទាំងអស់​នៅ​ក្នុង​ឯកសារ .env ទៅ​ដាក់​នៅ​កន្លែង Contents of .env file ចុង​ក្រោយ​បង្អស់​ចុច Import variables ។</p><p>&nbsp;</p><p>ដើម្បី​អោយ​កញ្ចប់ Prisma អាច​ត្រូវ​តំលើង​នៅ​លើ​ប្រព័ន្ធ Netlify យើង​ត្រូវ​សរសេរ​បន្ថែម​កូដ​នៅ​ក្នុង​ឯកសារ package.json នៅ​ត្រង់​កន្លែង scripts ថា "postinstall": "prisma generate" ដូច​ខាង​ក្រោម​នេះ​៖</p><pre><code class="js javascript js-code">{
  "name": "dynamic-blog",
  "type": "module",
  "version": "0.0.1",
  "scripts": {
    "dev": "astro dev",
    "build": "astro build",
    "preview": "astro preview",
    "astro": "astro",
    "postinstall": "prisma generate"
  },
  "dependencies": {
    "@astrojs/netlify": "^6.5.8",
    "@astrojs/svelte": "^7.1.0",
    "@prisma/adapter-libsql": "^6.14.0",
    "@prisma/client": "^6.14.0",
    "astro": "^5.13.3",
    "bcryptjs": "^3.0.2",
    "svelte": "^5.38.3",
    "typescript": "^5.9.2"
  },
  "devDependencies": {
    "prisma": "^6.14.0"
  }
}
</code></pre><p>&nbsp;</p><p>Netlify: <a href="https://khmerweb-dynamic-blog.netlify.app/login">https://khmerweb-dynamic-blog.netlify.app/login</a></p><p>GitHub: <a href="https://github.com/khmerweb/dynamic-blog">https://github.com/khmerweb/dynamic-blog</a></p>