---
id: '16100483'
title: 'បង្កើត​ជំពូក'
categories: 'Node.js, Astro'
thumb: ''
date: '2025-09-02T13:07:13'
bookTitle: 'Astro Dynamic Website'
bookThumb: ''
bookChapter: 'ទំព័រ​ជំពូក'
videos: ''
---
<p>មុន​នឹង​អាច​បញ្ចូល​ទិន្នន័យ​ទៅ​រក្សាទុក​នៅ​ក្នុង​មូលដ្ឋាន​ទិន្នន័យ​បាន យើង​ចាំបាច់​ត្រូវ​បង្កើតក្បួន​ខ្នាត​ Prisma មួយដែល​អាច​បំពេញ​​តួនាទី​នេះ​បាន​។</p><pre><code class="js javascript js-code">// models/category.js

import prisma from './prisma.js'

class Category{
    async count(){
        return await prisma.category.count()
    }
	...
    async createCategory(category){
        await prisma.category.create({
            data: {
                id: crypto.randomUUID(),
                title: category.title,
                thumb: category.thumb,
                date: category.date,
            }
        })
    }
    ...
}

export default new Category()</code></pre><p>&nbsp;</p><p>ក្រោយ​ពី​បញ្ចូល​ទិន្នន័យ​ទៅ​ក្នុង​ទំរង់បែបបទ​នៃ​គំរូ​ទំព័រ​ជំពូក​​រួច​ហើយ ការចុច​ប៊ូតុង «ចុះផ្សាយ» នឹង​ធ្វើ​អោយ​ទិន្នន័យ​ទាំងនោះ​ត្រូវ​បញ្ជូន​ទៅ​ឯកសារ index.astro នៅ​ក្នុង​ថត src/pages/admin/category ។ ទិន្នន័យ​ទាំងនោះ​នឹង​ត្រូវ​ស្រង់​យក​ពី​​សំណុំ​ទិន្នន័យ formData ហើយ​ក្រោយ​ពី​បាន​ត្រួត​ពិនិត្យ​តួនាទី​របស់​អ្នក​និពន្ធថា​ពិត​ជា​ Admin ពិត​ប្រាកដ​មែន ​ទិន្នន័យ​ទាំងនោះ​នឹង​ត្រូវ​បញ្ជូន​ទៅ​រក្សា​ទុក​នៅ​ក្នុង​មូលដ្ឋាន​ទិន្នន័យ​។</p><pre><code class="js javascript js-code">&lt;!--src/pages/admin/category/index.astro--&gt;
---
// @ts-nocheck
const user = await Astro.session?.get('user')
if(!user){return Astro.redirect('/login')}

import Layout from "../../../components/admin/Layout.astro"
import Category from "../../../components/admin/Category.svelte"
import categoryDb from "../../../models/category.js"
import setup from "../../../settings.js"

let form = null

if(Astro.request.method === "POST"){
    form = {}
    const formData = await Astro.request.formData()
    const title = formData.get('label')
    const thumb = formData.get("thumb")
    const date = formData.get("datetime")

    const validate = (
        typeof title === 'string' &amp;&amp; title !== '' &amp;&amp;
        typeof thumb === 'string' &amp;&amp; thumb !== '' &amp;&amp;
        typeof date === 'string' &amp;&amp; date !== ''
    )

    if(validate){
        const category = {title, thumb, date}
        if(user.role == 'Admin'){
            await categoryDb.createCategory(category)
            form.info = 'ជំពូក​​មួយ​ត្រូវ​បាន​បង្កើត​ឡើង!'
            form.success = true
        }else{
            form.info = 'អ្នក​គ្មាន​សិទ្ធិ​បង្កើត​ជំពូក​ឡើយ!'
            form.success = false
        }
    }else{
        form.info = "ទិន្នន័យ​បញ្ជូន​មក​មិន​ត្រឹមត្រូវ​ទេ!"
        form.success = false
    }
}

const settings = await setup()
const items = []
const count = await categoryDb.count()
const pageNumber = 1

const data = {user, count, items, info:"ជំពូក", type:"category", pageNumber, form}
---

&lt;Layout title="ទំព័រ​ជំពូក" data={data} &gt;
    &lt;Category slot="editor" {data} client:load /&gt;
&lt;/Layout&gt;</code></pre><p>&nbsp;</p><p>Netlify: <a href="https://khmerweb-dynamic-blog.netlify.app/login">https://khmerweb-dynamic-blog.netlify.app/login</a></p><p>GitHub: <a href="https://github.com/khmerweb/dynamic-blog">https://github.com/khmerweb/dynamic-blog</a></p>