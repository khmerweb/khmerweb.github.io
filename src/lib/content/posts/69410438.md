---
id: '69410438'
title: 'យន្តការ​ផ្ទៀងផ្ទាត់'
categories: 'Node.js, Astro'
thumb: ''
date: '2025-08-28T23:25:35'
bookTitle: 'Astro Dynamic Website'
bookThumb: ''
bookChapter: 'ទំព័រ​ចូល​ក្នុង'
videos: ''
---
<p>ក្រោយ​ពី​បាន​ត្រួត​ពិនិត្យ​អ្នក​ចុះ​ឈ្មោះ​ចូល​ទំព័រ​គ្រប់គ្រង​និង​បាន​រក្សាទុក​នូវ​ទិន្នន័យ​របស់​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​អ្នក​​ចុះ​ឈ្មោះនៅ​លើ server ​​រួច​ហើយ នៅ​ពេល​ក្រោយ​ៗ​មក​ទៀត យើង​អាច​ធ្វើការផ្ទៀងផ្ទាត់​មើល​ថា​តើ​អ្នក​ចុះ​ឈ្មោះ​ណាមួយ​ដែល​ត្រូវ​បាន​ត្រួត​ពិនិត្យ​រួច​ហើយ និង​ដែល​មាន​ទិន្នន័យ​​​ត្រូវ​បាន​រក្សាទុក​​នៅ​លើ server​ ។ បើ​ត្រូវ​បាន​ត្រួតពិនិត្យ​រួច​ហើយ យើង​អាច​បញ្ជូន​អ្នក​នោះ​​ទៅ​កាន់​ទំព័រ​គ្រប់គ្រងតែម្តង​ ដោយ​ពុំ​ចាំបាច់​ត្រូវ​ចុះ​ឈ្មោះ​នៅ​លើ​ទំព័រ​ចូល​ក្នុង​ទៀត​ឡើយ​​។ យន្តការ​ផ្ទៀងផ្ទាត់​នេះ​ត្រូវ​ធ្វើ​ឡើង​តាម​រយៈ​វត្ថុ​ឈ្មោះ Astro.session ៕</p><pre><code class="js javascript js-code">&lt;!--src/pages/login.astro--&gt;
---
import Base from "../components/Base.astro"
import bcrypt from "bcryptjs"
import user from "../models/user.js"
const session = await Astro.session?.get('user')
if(session){ return Astro.redirect("/admin")}

let message = ''
if(Astro.request.method === "POST"){
    const data = await Astro.request.formData()
    const email = data.get("email")
    const password = data.get("password")

    let loginUser = null
    const validate = (
        typeof email === 'string' &amp;&amp; email !== '' &amp;&amp;
        typeof password === 'string' &amp;&amp; password !== ''
    )
    if(validate){
        loginUser = await user.checkUser(email)
        if(loginUser){
            if(bcrypt.compareSync(password, loginUser.password)){
                await Astro.session?.set('user', loginUser)
                return Astro.redirect("/admin")
            }else{
                message = 'ពាក្យ​សំងាត់​មិន​ត្រឹមត្រូវ​ទេ'         
            }
        }else{
            message = 'Email មិន​ត្រឹមត្រូវទេ'
        }
    }else{
        message = "ទិន្នន័យ​បញ្ជូន​មក​មិន​ត្រឹមត្រូវ​ទេ!"
    }
}
---

&lt;Base pageTitle="Login"&gt;
    &lt;div class="wrapper"&gt;
        &lt;h2&gt;ចុះ​ឈ្មោះ​ចូល​ទំព័រ​គ្រប់គ្រង&lt;/h2&gt;
        &lt;form action="/login" method="POST"&gt;
            &lt;label for="email"&gt;Email:&lt;/label&gt;
            &lt;input type="text" id="email" name="email" required /&gt;
            &lt;br /&gt;
            &lt;label for="password"&gt;ពាក្យ​សំងាត់ៈ&lt;/label&gt;
            &lt;input type="password" id="password" name="password" required /&gt;
            &lt;br /&gt;
            &lt;button type="submit"&gt;បញ្ជូន&lt;/button&gt;
            &lt;span class="message"&gt;{message}&lt;/span&gt;
        &lt;/form&gt;
    &lt;/div&gt;
&lt;/Base&gt;

&lt;style&gt;
    .wrapper {
        max-width: 300px;
        margin: 100px auto;
        background-color: lightgrey;
    }

    .wrapper h2 {
        padding: 10px 0;
        font: normal 20px/1.5 Koulen;
        text-align: center;
        background-color: #333;
        color: white;
    }

    .wrapper form {
        display: flex;
        flex-direction: column;
        padding: 0 20px 20px;
        font: 14px/1.5 Vidaloka, OdorMeanChey;
    }
    
    .wrapper form input {
        padding: 8px;
    }
    
    .wrapper form button {
        font: 14px/1.5 OdorMeanChey;
        padding: 10px;
        background-color: #4CAF50;
        color: white;
        border: none;
        cursor: pointer;
    }
    
    .wrapper form button:hover {
        background-color: #45a049;
    }

    .wrapper form .message {
        color: red;
        text-align: center;
        padding-top: 10px;
    }
&lt;/style&gt;</code></pre><p>&nbsp;</p><p>Netlify: <a href="https://khmerweb-dynamic-blog.netlify.app/login">https://khmerweb-dynamic-blog.netlify.app/login</a></p><p>GitHub: <a href="https://github.com/khmerweb/dynamic-blog">https://github.com/khmerweb/dynamic-blog</a></p>