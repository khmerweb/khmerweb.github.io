---
id: '93492588'
title: 'គំរូ​ទំព័រ​ការផ្សាយ'
categories: 'Node.js, Astro'
thumb: ''
date: '2025-08-30T14:00:12'
bookTitle: 'Astro Dynamic Website'
bookThumb: ''
bookChapter: 'ទំព័រ​ការផ្សាយ'
videos: ''
---
<p>គំរូ​ទំព័រ​ការផ្សាយ​ (post page) ផ្សំ​ឡើង​ដោយ​ផ្នែក​ផ្សេង​ៗ​ជា​ច្រើន មាន​ដូច​ជា​ផ្នែក​ចំណងជើង ផ្ទាំង​វាយ​អត្ថបទ ផ្នែក​ជ្រើស​រើសជំពូក ផ្នែក​រូបតំណាង ផ្នែក​កាលបរិច្ឆេទ និង​ ផ្នែក​បញ្ចូល​វីដេអូ​។ សំរាប់​ផ្នែក​វាយ​អត្ថបទ យើង​អាច​ប្រើប្រាស់​កម្មវិធី​​បើក​ចំហរ ckeditor ដែលអាច​ត្រូវ​ទាញយក​ពី​គេហទំព័រ <a href="https://ckeditor.com/ckeditor-5/download/">https://ckeditor.com/ckeditor-5/download/</a> យក​មក​ទុក​នៅ​ក្នុង​ថត public/scripts/ckeditor ។ បន្ទាប់​មក​ទៀត យើង​ត្រូវ​បង្កើត​ឯកសារ config.js មួយ​និង​រក្សា​វា​ទុក​នៅ​ក្នុង​ថត public/scripts/ckeditor ។</p><pre><code class="js javascript js-code">// public/scripts/ckeditor/config.js
var ckeditor

ClassicEditor
    .create( document.querySelector( '#editor' ), {
        toolbar: ['fontfamily', 'fontsize', 'fontcolor', 'bold', 'italic', 
            'bulletedList', 'indent', 'outdent', 'numberedList', 'link', 'blockQuote', 
            'insertTable','code', 'codeblock', 'imageinsert', 'mediaembed', 'undo', 'redo' ],
        fontFamily: {
            options: [
                'ឧត្តមាន​ជ័យ, OdorMeanChey', 'អក្សរដៃ, HandWriting',
                'គូលេន, Koulen', 'ក្រូច​ឆ្នារ, Limonf3',
                'បាយ័ន, Bayon', 'ក្រសាំង, Rooster',
                'មូល, Moul',
    			'Arial, Helvetica, sans-serif',
 				'Courier New, Courier, monospace',
 				'Georgia, serif',
 				'Lucida Sans Unicode, Lucida Grande, sans-serif',
 				'Tahoma, Geneva, sans-serif',
 				'Times New Roman, Times, serif',
 				'Trebuchet MS, Helvetica, sans-serif',
				'Verdana, Geneva, sans-serif',
            ],
            supportAllValues: true
        },
          
        fontSize: {
            options: [
                9,
                11,
                13,
                'default',
                17,
                19,
                21
            ],
            supportAllValues: true
        },

        codeBlock: {
			languages: [
				// Do not render the CSS class for the plain text code blocks.
				{ language: 'plaintext', label: 'Plain text', class: '' },
              	{ language: 'svelte', label: 'Svelte', class: 'svelte' },
              	{ language: 'css', label: 'CSS', class: 'css' },
				// Use the "php-code" class for PHP code blocks.
				{ language: 'php', label: 'PHP', class: 'php-code' },
				// Use the "js" class for JavaScript code blocks.
				// Note that only the first ("js") class will determine the language of the block when loading data.
				{ language: 'javascript', label: 'JavaScript', class: 'js javascript js-code' },
				// Python code blocks will have the default "language-python" CSS class.
				{ language: 'python', label: 'Python' }
            ] 
        },
      })
      .then( editor =&gt; {
          ckeditor = editor
          editor.editing.view.focus()
          editor.editing.view.change(writer=&gt;{
              writer.setStyle('height', '270px', editor.editing.view.document.getRoot())
          })
      })
      .catch( err =&gt; {
          console.error( err.stack )
      })</code></pre><p>&nbsp;</p><p>ការបង្កើត​ផ្ទាំង​វាយ​អត្ថបទ​ដែល​ជា​កម្មវិធី ckeditor ត្រូវ​ធ្វើ​ឡើង​ដោយ​បញ្ចូល​តំណរភ្ជាប់​ទៅ​កាន់​ឯកសារ ckeditor.js និង​ឯកសារ config.js ទៅ​ក្នុង​ឯកសារ Post.svelte ។</p><pre><code>&lt;script src="/scripts/ckeditor/ckeditor.js"&gt;&lt;/script&gt;</code></pre><pre><code>&lt;script src="/scripts/ckeditor/config.js"&gt;&lt;/script&gt;</code></pre><p>&nbsp;</p><p>ជា​រួម ​គំរួ​ទំព័រការផ្សាយ​មាន​​ទំរង់​ដូ​ច​ខាង​ក្រោម​នេះ​៖</p><pre><code class="svelte">&lt;!--src/components/admin/Post.svelte--&gt;
&lt;script&gt;
    // npm install jquery
    import jq from 'jquery'

    let { data } = $props()
    let category = $state(undefined)
    let categories = $state('')
    let json = $state('')
    let type = $state(undefined)
    let id = $state(undefined)
    let status = $state(undefined)
    let videos = $state([])

    function getCategory(){
        if(categories === ''){
            categories += category
        }else{
            categories += (`, ${category}`)
        }
    }

    function submitForm(){
        if(videos.length){
            let newVideos = []
            let part = {}
            let key = {0:'type', 1:'id', 2:'status'}

            for(let v=1; v&lt;=videos.length; v++){
                for(let j=0; j&lt;3; j++){
                    part[key[j]] = jq(`.viddata div:eq(${v}) input:eq(${j})`).val()
                }

                newVideos.push({...part})
            }

            json = JSON.stringify(newVideos)
        }else{
            json = ''
        }
    }

    const genJson = () =&gt; {        
        let video = {type, id, status}
        let success = false
    
        for(let v in video){
            if(!video[v]){
                alert('ចូរ​បំពេញ​កន្លែង​អត្តសញ្ញាណ​វីដេអូ')
                success = false
                break
            }else{
                success = true
            }
        }

        if(success){
            videos = [video, ...videos]
            json = JSON.stringify(videos)
        }  
    }

    function deleteRow(e) {
        let index = parseInt(e.target.innerHTML)
        videos.splice(videos.length - index, 1)
        videos = [...videos]
    }

    function save_data_check(){        
        return "Your changes may not be saved."
    }

    $effect(()=&gt;{
        jq('.Editor input').on('change', () =&gt; {
            window.onbeforeunload = save_data_check
        })

        ckeditor.model.document.on( 'change', () =&gt; {
            window.onbeforeunload = save_data_check
        } )
    })
&lt;/script&gt;

&lt;div class="Editor"&gt;
    &lt;script src="/scripts/ckeditor/ckeditor.js"&gt;&lt;/script&gt;
    &lt;form action="/admin/post?/create" method="post" onsubmit={submitForm}&gt;
        &lt;input type="text" name="title" required placeholder="ចំណងជើង" /&gt;
        &lt;div class="wrapper"&gt;
            &lt;textarea name="content" id="editor"&gt;&lt;/textarea&gt;
        &lt;/div&gt;
        &lt;input type="text" bind:value={categories} name="categories" required placeholder="ជំពូក" /&gt;
        &lt;div class="frame"&gt;
            &lt;select name="category" bind:value={category} onchange={getCategory} &gt;
                &lt;option disabled selected&gt;ជ្រើសរើស​យក​ជំពូក&lt;/option&gt;
                {#each data?.categories as category}
                &lt;option&gt;{category.title}&lt;/option&gt;
                {/each}
            &lt;/select&gt;
            &lt;input type="text" name="thumb" required placeholder="រូប​​តំណាង" /&gt;
            &lt;input type="datetime-local" step="1" name="datetime" required /&gt;
            &lt;input type="submit" value="ចុះ​ផ្សាយ" /&gt;
            &lt;input type="hidden" name="videos" bind:value={json} /&gt;
        &lt;/div&gt;
        &lt;script src="/scripts/ckeditor/config.js"&gt;&lt;/script&gt;
    &lt;/form&gt;
    &lt;div class='form'&gt;
        &lt;select name='type' bind:value={type} &gt;
            &lt;option&gt;YouTube&lt;/option&gt;
            &lt;option&gt;YouTubePlaylist&lt;/option&gt;
            &lt;option&gt;Facebook&lt;/option&gt;
            &lt;option&gt;OK&lt;/option&gt;
            &lt;option&gt;Dailymotion&lt;/option&gt;
            &lt;option&gt;Vimeo&lt;/option&gt;
        &lt;/select&gt;
        &lt;input name='videoid' bind:value={id} type='text' placeholder="អត្តសញ្ញាណ​វីដេអូ" required /&gt;
        &lt;select name='status' bind:value={status} &gt;
            &lt;option&gt;ចប់&lt;/option&gt;
            &lt;option&gt;នៅ​មាន​ត&lt;/option&gt;
            &lt;option&gt;~ ចប់&lt;/option&gt;
        &lt;/select&gt;
        &lt;input onclick={genJson} type="button" value="បញ្ចូលវីដេអូ" /&gt;
    &lt;/div&gt;
    &lt;div class='viddata'&gt;
        &lt;div&gt;
            {#if videos.length}
            &lt;b&gt;ប្រភេទ​វីដេអូ​&lt;/b&gt;&lt;b&gt;អត្តសញ្ញាណ​វីដេអូ​&lt;/b&gt;&lt;b&gt;ស្ថានភាព&lt;/b&gt;&lt;b&gt;ភាគ/លុប&lt;/b&gt;
            {/if}
        &lt;/div&gt;
        {#each videos as video, i}
        &lt;div&gt;
            &lt;input value={video.type} required /&gt;
            &lt;input value={video.id} required /&gt;
            &lt;input value={video.status} required /&gt;
            &lt;p title="Delete" onclick={deleteRow} class="episode"&gt;{videos.length-i}&lt;/p&gt;
        &lt;/div&gt;
        {/each}
    &lt;/div&gt;
&lt;/div&gt;

&lt;style&gt;
    .Editor{
        background-color: white;
        height: 100%;
    } 
    .Editor .wrapper{
        height: 310px;
    }
    .Editor input, .Editor select,
    .Editor .form input, .Editor .form select{
        width: 100%;
        font: var(--body-font);
        padding: 3px 5px;
    }
    .Editor .frame, .Editor .form, .Editor .viddata div{
        display: grid;
        grid-template-columns: 20% 32.5% 32.5% 15%;
    }
    .Editor .viddata div{
        width: 100%;
    }
    .Editor .viddata div p:hover{
        cursor: pointer;
        color: red;
    }
    .Editor .viddata b,
    .Editor .viddata input,
    .Editor .viddata p{
        font: var(--body-font);
        padding: 5px;
        background: lightgrey;
        border: 1px solid grey;
        text-align: center;
        color: black;
    }
    .Editor .viddata input{
        background: white;
    }
&lt;/style&gt;</code></pre><pre><code class="js javascript js-code">&lt;!--src/pages/admin/post.astro--&gt;
---
// @ts-nocheck
const user = await Astro.session?.get('user')
if(!user){return Astro.redirect('/login')}

import Layout from "../../components/admin/Layout.astro"
import Post from "../../components/admin/Post.svelte"
const data = {}
---
 
&lt;Layout title="ទំព័រ​ការផ្សាយ" data={data} user={user} &gt;
    &lt;Post slot="editor" {data} client:load /&gt;
&lt;/Layout&gt;</code></pre><p>&nbsp;</p><p>Netlify: <a href="https://khmerweb-dynamic-blog.netlify.app/login">https://khmerweb-dynamic-blog.netlify.app/login</a></p><p>GitHub: <a href="https://github.com/khmerweb/dynamic-blog">https://github.com/khmerweb/dynamic-blog</a></p>