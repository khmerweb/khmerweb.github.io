---
id: '10694735'
title: 'លុប​ជំពូក'
categories: 'Node.js, Astro'
thumb: ''
date: '2025-09-02T15:04:31'
bookTitle: 'Astro Dynamic Website'
bookThumb: ''
bookChapter: 'ទំព័រ​ជំពូក'
videos: ''
---
<p>មុន​នឹង​អាច​លុប​​​ទិន្នន័យ​ជំពូក​​ពី​ក្នុង​មូលដ្ឋាន​ទិន្នន័យ​បាន យើង​ចាំបាច់​ត្រូវ​បង្កើតក្បួន​ខ្នាត​ Prisma មួយដែល​អាច​បំពេញ​​តួនាទី​នេះ​បាន​៖</p><pre><code class="js javascript js-code">import prisma from './prisma.js'

class Category{
	...
	async deleteCategory(params){
        await prisma.category.delete({ where: {id: params.id } })
    }
	...
}

export default new Category()</code></pre><p>&nbsp;</p><p>ស្រដៀង​គ្នា​នឹង​ការលុប​ទំព័រ​ការផ្សាយ ការលុប​ជំពូក​ត្រូវ​ធ្វើ​ឡើង​នៅ​ក្នុង​ក្បួន​ចុង​ផ្លូវ​ឬ API Endpoint នៅ​ក្នុង​ថត ​src/pages/admin/category/delete ។ ឯកសារ​នៃ​ក្បួន​ចុង​ផ្លូវ​ឬ​ API Endpoint ​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ត្រូវមាន​ឈ្មោះ​ថា [id].js ដែល​ជា​ប៉ារ៉ាម៉ែត​មួយ​ចាំទទួល​យក​អត្តសញ្ញាណ​របស់​ជំពូក​​ដែល​ត្រូវ​លុប​។ បាន​ន័យ​ថា​ផ្លូវ​សំរាប់​លុប​ឯកសារ​ស្តាទិក​ក៏​​ជា​ផ្លូវ​ឌីណាមិក​មួយ​ដែរ​។</p><pre><code class="js javascript js-code">// src/pages/admin/category/delete/[id].js
import categoryDb from "../../../../models/category.js"

export async function GET({ session, params, redirect, cookies }){
    const user = await session.get('user')
    if(!user){return redirect('/login')}

    if(user.role === 'Admin'){
        await categoryDb.deleteCategory(params)
        cookies.set('form', JSON.stringify({success:true, info:'លុប​បាន​ដោយ​ជោគជ័យ!'}), { path: '/' })
    }else{
        cookies.set('form', JSON.stringify({success:false, info:'អ្នក​គ្មាន​សិទ្ធិ​លុប​ជំពូក​បាន​ឡើយ​!'}), { path: '/' })
    }

    return redirect('/admin/category')
}</code></pre><p>&nbsp;</p><p>យ៉ាងណាម៉ិញ ដើម្បី​អាច​ស្រង់​យក​ទិន្នន័យ​នៅ​ក្នុង cookie ដែល​ក្បួន​ចុង​ផ្លូវ​នៅ​ក្នុង​ឯកសារ​ខាង​លើ​បាន​បង្កើត​ឡើង យើង​សរសេរ​បន្ថែម​កូដ​នៅ​ក្នុង​​​​​ឯកសារ index.astro នៅ​ក្នុង​ថត rc/pages/admin/category ដូច​ខាង​ក្រោម​នេះ៖</p><pre><code class="js javascript js-code">&lt;!--src/pages/admin/category/index.astro--&gt;
...
const formCookie = Astro.cookies.get('form')
if(formCookie){
    data.form = JSON.parse(formCookie.value)
    Astro.cookies.delete("form", { path: '/' })
}
...</code></pre><p>&nbsp;</p><p>Netlify: <a href="https://khmerweb-dynamic-blog.netlify.app/login">https://khmerweb-dynamic-blog.netlify.app/login</a></p><p>GitHub: <a href="https://github.com/khmerweb/dynamic-blog">https://github.com/khmerweb/dynamic-blog</a></p>