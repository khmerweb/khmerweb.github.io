---
id: '52923193'
title: 'Using Preload Scripts'
categories: 'Node.js, Sveltekit'
thumb: ''
date: '2025-09-05T16:12:06'
bookTitle: 'Desktop App with Electron'
bookThumb: ''
bookChapter: 'Introduction'
videos: ''
---
<p>from Electron team</p><p>&nbsp;</p><p><span style="font-size:21px;"><strong>What is a preload script?</strong></span></p><p>&nbsp;</p><p>Electron's main process is a Node.js environment that has full operating system access. On top of Electron modules, you can also access Node.js built-ins, as well as any packages installed via npm. On the other hand, renderer processes run web pages and do not run Node.js by default for security reasons.</p><p>&nbsp;</p><p>To bridge Electron's different process types together, we will need to use a special script called a <span style="color:hsl(0,75%,60%);"><strong>preload</strong></span>.</p><p>&nbsp;</p><p><span style="font-size:21px;"><strong>Augmenting the renderer with a preload script</strong></span></p><p>&nbsp;</p><p>A BrowserWindow's preload script runs in a context that has access to both the HTML DOM and a limited subset of Node.js and Electron APIs.</p><p>&nbsp;</p><p>Preload scripts are injected before a web page loads in the renderer, similar to a Chrome extension's content scripts. To add features to your renderer that require privileged access, you can define global objects through the contextBridge API.</p><p>&nbsp;</p><p>To demonstrate this concept, you will create a preload script that exposes your app's versions of Chrome, Node, and Electron into the renderer.</p><p>&nbsp;</p><p>Add a new preload.js script that exposes selected properties of Electron's process.versions object to the renderer process in a versions global variable.</p><pre><code class="js javascript js-code">const { contextBridge } = require('electron')

contextBridge.exposeInMainWorld('versions', {
  node: () =&gt; process.versions.node,
  chrome: () =&gt; process.versions.chrome,
  electron: () =&gt; process.versions.electron
  // we can also expose variables, not just functions
})</code></pre><p>&nbsp;</p><p>To attach this script to your renderer process, pass its path to the webPreferences.preload option in the BrowserWindow constructor:</p><pre><code class="js javascript js-code">const { app, BrowserWindow } = require('electron')

const path = require('node:path')

const createWindow = () =&gt; {
  const win = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
      preload: path.join(__dirname, 'preload.js')
    }
  })

  win.loadFile('index.html')
}

app.whenReady().then(() =&gt; {
  createWindow()
})</code></pre><p>&nbsp;</p><p>At this point, the renderer has access to the versions global, so let's display that information in the window. This variable can be accessed via window.versions or simply versions. Create a renderer.js script that uses the document.getElementById DOM API to replace the displayed text for the HTML element with info as its id property.</p><pre><code class="js javascript js-code">const information = document.getElementById('info')
information.innerText = `This app is using Chrome (v${versions.chrome()}), Node.js (v${versions.node()}), and Electron (v${versions.electron()})`</code></pre><p>&nbsp;</p><p>Then, modify your index.html by adding a new element with info as its id property, and attach your renderer.js script:</p><pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset="UTF-8" /&gt;
    &lt;meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'"
    /&gt;
    &lt;meta
      http-equiv="X-Content-Security-Policy"
      content="default-src 'self'; script-src 'self'"
    /&gt;
    &lt;title&gt;Hello from Electron renderer!&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Hello from Electron renderer!&lt;/h1&gt;
    &lt;p&gt;ðŸ‘‹&lt;/p&gt;
    &lt;p id="info"&gt;&lt;/p&gt;
  &lt;/body&gt;
  &lt;script src="./renderer.js"&gt;&lt;/script&gt;
&lt;/html&gt;</code></pre><p>&nbsp;</p><p><span style="font-size:21px;"><strong>Communicating between processes</strong></span></p><p>&nbsp;</p><p>As we have mentioned above, Electron's main and renderer process have distinct responsibilities and are not interchangeable. This means it is not possible to access the Node.js APIs directly from the renderer process, nor the HTML Document Object Model (DOM) from the main process.</p><p>&nbsp;</p><p>The solution for this problem is to use Electron's ipcMain and ipcRenderer modules for inter-process communication (IPC). To send a message from your web page to the main process, you can set up a main process handler with ipcMain.handle and then expose a function that calls ipcRenderer.invoke to trigger the handler in your preload script.</p><p>&nbsp;</p><p>To illustrate, we will add a global function to the renderer called ping() that will return a string from the main process.</p><p>&nbsp;</p><p>First, set up the invoke call in your preload script:</p><pre><code class="js javascript js-code">// preload.js
const { contextBridge, ipcRenderer } = require('electron')

contextBridge.exposeInMainWorld('versions', {
  node: () =&gt; process.versions.node,
  chrome: () =&gt; process.versions.chrome,
  electron: () =&gt; process.versions.electron,
  ping: () =&gt; ipcRenderer.invoke('ping')
  // we can also expose variables, not just functions
})</code></pre><p>&nbsp;</p><p>Then, set up your handle listener in the main process. We do this before loading the HTML file so that the handler is guaranteed to be ready before you send out the invoke call from the renderer.</p><pre><code class="js javascript js-code">const { app, BrowserWindow, ipcMain } = require('electron/main')

const path = require('node:path')

const createWindow = () =&gt; {
  const win = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
      preload: path.join(__dirname, 'preload.js')
    }
  })
  win.loadFile('index.html')
}
app.whenReady().then(() =&gt; {
  ipcMain.handle('ping', () =&gt; 'pong')
  createWindow()
})</code></pre><p>&nbsp;</p><p>Once you have the sender and receiver set up, you can now send messages from the renderer to the main process through the 'ping' channel you just defined.</p><pre><code class="js javascript js-code">// renderer.js
const func = async () =&gt; {
  const response = await window.versions.ping()
  console.log(response) // prints out 'pong'
}

func()</code></pre><p>&nbsp;</p><p><span style="font-size:21px;"><strong>Summary</strong></span></p><p>&nbsp;</p><p>A preload script contains code that runs before your web page is loaded into the browser window. It has access to both DOM APIs and Node.js environment, and is often used to expose privileged APIs to the renderer via the contextBridge API.</p><p>&nbsp;</p><p>Because the main and renderer processes have very different responsibilities, Electron apps often use the preload script to set up inter-process communication (IPC) interfaces to pass arbitrary messages between the two kinds of processes.</p><p>&nbsp;</p><p>In the next part of the tutorial, we will be showing you resources on adding more functionality to your app, then teaching you how to distribute your app to users.</p>