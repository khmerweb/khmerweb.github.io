---
id: '38502281'
title: 'ផ្ទៀងផ្ទាត់​ទិន្នន័យ'
categories: 'Node.js, Sveltekit'
thumb: ''
date: '2025-08-20T14:04:36'
bookTitle: 'SvelteKit in Detail'
bookThumb: ''
bookChapter: 'អំពី​ទំរង់​បែបបទ'
videos: ''
---
<p>ទិន្នន័យ​ដែល​ត្រូវ​បាន​បញ្ជូន​មក​ដោយ​អ្នក​ប្រើប្រាស់ ជួនកាល​មិន​ត្រឹមត្រូវ​ទេ ដូចនេះ យើង​ចាំបាច់​ត្រូវ​តែផ្ទៀងផ្ទាត់​មើល​ទិន្នន័យ​ទាំងនោះ​ជា​មុន​សិន មុន​នឹង​បញ្ចូល​ទិន្នន័យ​ទាំងនោះ​ទៅ​ក្នុង​មូលដ្ឋាន​ទិន្នន័យ​។ ជាទូទៅ ការផ្ទៀងផ្ទាត់​ត្រូវ​ធ្វើឡើង​ជាពីរ​ដំណាក់​កាល ដំណាក់កាល​ទី​មួយ​ត្រូវ​ធ្វើឡើង​នៅ​ក្នុង browser ដោយ​ប្រើប្រាស់​លក្ខណៈ required នៅ​ក្នុង​ធាតុ HTML ។ ពិនិត្យ​កម្មវិធី​ខាង​ក្រោម​នេះ៖</p><pre><code class="svelte">&lt;!--src/routes/+page.svelte--&gt;
&lt;script&gt;
	let { data, form } = $props();
&lt;/script&gt;

&lt;div class="centered"&gt;
	&lt;h1&gt;todos&lt;/h1&gt;

	{#if form?.error}
		&lt;p class="error"&gt;{form.error}&lt;/p&gt;
	{/if}

	&lt;form method="POST" action="?/create"&gt;
		&lt;label&gt;
			add a todo:
			&lt;input
				name="description"
				value={form?.description ?? ''}
				autocomplete="off"
				required
			/&gt;
		&lt;/label&gt;
	&lt;/form&gt;

	&lt;ul class="todos"&gt;
		{#each data.todos as todo (todo.id)}
			&lt;li&gt;
				&lt;form method="POST" action="?/delete"&gt;
					&lt;input type="hidden" name="id" value={todo.id} /&gt;
					&lt;span&gt;{todo.description}&lt;/span&gt;
					&lt;button aria-label="Mark as complete"&gt;&lt;/button&gt;
				&lt;/form&gt;
			&lt;/li&gt;
		{/each}
	&lt;/ul&gt;
&lt;/div&gt;

&lt;style&gt;
	.centered {
		max-width: 20em;
		margin: 0 auto;
	}

	label {
		width: 100%;
	}

	input {
		flex: 1;
	}

	span {
		flex: 1;
	}

	button {
		border: none;
		background: url(./images/delete.png) no-repeat 50% 50%;
		background-size: 1rem 1rem;
		cursor: pointer;
		height: 100%;
		aspect-ratio: 1;
		opacity: 0.5;
		transition: opacity 0.2s;
	}

	button:hover {
		opacity: 1;
	}

&lt;/style&gt;</code></pre><p>&nbsp;</p><p>ដំណាក់កាល​ទី ២ ត្រូវ​ធ្វើ​ឡើង​នៅ​លើ​ server នៅ​ក្នុង​ក្បួន​​ឆ្លើយ​តប​នឹង​ទំរង់បែបបទ​។ ពិនិត្យ​កម្មវិធី​ខាងក្រោម​នេះ៖</p><pre><code class="js javascript js-code">// src/routes/+page.server.js
import { fail } from '@sveltejs/kit';
import * as db from '$lib/server/database.js';

export function load({ cookies }) {
	let id = cookies.get('userid');

	if (!id) {
		id = crypto.randomUUID();
		cookies.set('userid', id, { path: '/' });
	}

	return {
		todos: db.getTodos(id)
	};
}

export const actions = {
	create: async ({ cookies, request }) =&gt; {
		const data = await request.formData();

		try {
			db.createTodo(cookies.get('userid'), data.get('description'));
		} catch (error) {
			return fail(422, {
				description: data.get('description'),
				error: error.message
			});
		}
	},

	delete: async ({ cookies, request }) =&gt; {
		const data = await request.formData();
		db.deleteTodo(cookies.get('userid'), data.get('id'));
	}
};</code></pre><pre><code class="js javascript js-code">// src/lib/server/database.js
// In a real app, this data would live in a database,
// rather than in memory. But for now, we cheat.
const db = new Map();

export function getTodos(userid) {
	if (!db.get(userid)) {
		db.set(userid, [{
			id: crypto.randomUUID(),
			description: 'Learn SvelteKit',
			done: false
		}]);
	}

	return db.get(userid);
}

export function createTodo(userid, description) {
	if (description === '') {
		throw new Error('todo must have a description');
	}

	const todos = db.get(userid);

	if (todos.find((todo) =&gt; todo.description === description)) {
		throw new Error('todos must be unique');
	}

	todos.push({
		id: crypto.randomUUID(),
		description,
		done: false
	});
}

export function deleteTodo(userid, todoid) {
	const todos = db.get(userid);
	const index = todos.findIndex((todo) =&gt; todo.id === todoid);

	if (index !== -1) {
		todos.splice(index, 1);
	}
}
</code></pre>